<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Golang Unzip File Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="title" content="Golang Unzip File Example" />
    <meta name="keywords" content="golang, golang tutorial, golang unzip, golang unzip archive, golang unzip file, golang unzip file example, go tutorial, go unzip tutorial, go unzip archive" />
    <meta name="description" content="Golang Unzip File Example" />
    <meta itemprop="name" content="Golang Unzip File Example">
    <meta itemprop="description" content="Golang Unzip File Example">
    <meta itemprop="image" content="https://golang.cafe/s/img/cafe.jpg">
    <meta property="og:url" content="https://golang.cafe">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Golang Unzip File Example">
    <meta property="og:description" content="Golang Unzip File Example">
    <meta property="og:image" content="https://golang.cafe/s/img/cafe.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Golang Unzip File Example">
    <meta name="twitter:description" content="Golang Unzip File Example">
    <meta name="twitter:image" content="https://golang.cafe/s/img/cafe.jpg">
    <meta name="twitter:site" content="@golangcafe"/>
    <style type="text/css">
body{background:#ffffff;}
      input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}th{font-weight:600}td,th{border-bottom:1.08px solid #595959;overflow:auto;padding:14.85px 18px;text-align:left;vertical-align:top}thead th{border-bottom-width:2.16px;padding-bottom:6.3px}table{display:table;overflow-x:auto}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}fieldset{display:flex;flex-direction:row;flex-wrap:wrap}fieldset legend{margin:18px 0}input,textarea,select,button{border-radius:3.6px;display:inline-block;padding:9.9px}input+label,input+input[type="checkbox"],input+input[type="radio"],textarea+label,textarea+input[type="checkbox"],textarea+input[type="radio"],select+label,select+input[type="checkbox"],select+input[type="radio"],button+label,button+input[type="checkbox"],button+input[type="radio"]{page-break-before:always}input,select,label{margin-right:3.6px}textarea{min-height:90px;min-width:360px}label{display:inline-block;margin-bottom:12.6px}label+*{page-break-before:always}label>input{margin-bottom:0}input[type="submit"],input[type="reset"],button{background:#f2f2f2;color:#191919;cursor:pointer;display:inline;margin-bottom:18px;margin-right:7.2px;padding:6.525px 23.4px;text-align:center}input[type="submit"]:hover,input[type="reset"]:hover,button:hover{background:#d9d9d9;color:#000}input[type="submit"][disabled],input[type="reset"][disabled],button[disabled]{background:#e6e5e5;color:#403f3f;cursor:not-allowed}input[type="submit"],button[type="submit"]{background:#000090;color:#fff}input[type="submit"]:hover,button[type="submit"]:hover{background:#0000c5;color:#ffffff}input,select,textarea{margin-bottom:18px}input[type="text"],input[type="password"],input[type="email"],input[type="url"],input[type="phone"],input[type="tel"],input[type="number"],input[type="datetime"],input[type="date"],input[type="month"],input[type="week"],input[type="color"],input[type="time"],input[type="search"],input[type="range"],input[type="file"],input[type="datetime-local"],select,textarea{border:1px solid #595959;padding:5.4px 6.3px}input[type="checkbox"],input[type="radio"]{flex-grow:0;height:29.7px;margin-left:0;margin-right:9px;vertical-align:middle}input[type="checkbox"]+label,input[type="radio"]+label{page-break-before:avoid}select[multiple]{min-width:270px}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}kbd,samp,var,output{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:14.4px}pre{border-left:1.8px solid #59c072;line-height:25.2px;overflow:auto;padding-left:18px}kbd{background:#daf1e0;border-radius:3.6px;color:#2a6f3b;display:inline-block;line-height:18px;padding:3.6px 6.3px 2.7px}kbd{background:#2a6f3b;color:#fff}mark{background:#ffc;padding:0 3.6px}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}h1,h2,h3,h4,h5,h6{color:#000;margin-bottom:18px}h1{font-size:36px;font-weight:500;line-height:41.4px;margin-top:72px}h2{font-size:25.2px;font-weight:400;line-height:30.6px;margin-top:54px}h3{font-size:21.6px;line-height:27px;margin-top:36px}h4{font-size:18px;line-height:23.4px;margin-top:18px}h5{font-size:14.4px;font-weight:bold;line-height:21.6px;text-transform:uppercase}h6{color:#595959;font-size:14.4px;font-weight:bold;line-height:18px;text-transform:uppercase}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}a{color:#000090;text-decoration:none}a:hover{text-decoration:underline}hr{border-bottom:1px solid #595959}figcaption,small{font-size:15.3px}figcaption{color:#595959}var,em,i{font-style:italic}dt,strong,b{font-weight:600}del,s{text-decoration:line-through}ins,u{text-decoration:underline}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}*{border:0;border-collapse:separate;border-spacing:0;box-sizing:border-box;margin:0;max-width:100%;outline:0;padding:0;vertical-align:baseline}html,body{width:100%}html{height:100%}body{color:#1a1919;}p,ul,ol,dl,blockquote,hr,pre,table,form,fieldset,figure,address{margin-bottom:29.7px}section{margin-left:auto;margin-right:auto;width:780px}article,header,footer{padding:43.2px}article{word-wrap: break-word;background:#fff;border:1px solid #d9d9d9;border-radius:7.2px}nav{text-align:center}nav ul{list-style:none;margin-left:0;text-align:center}nav ul li{display:inline-block;margin-left:9px;margin-right:9px;vertical-align:middle}nav ul li:last-child{margin-right:0}ol,ul{margin-left:31.5px}li dl,li ol,li ul{margin-bottom:0}dl{display:inline-block}dt{padding:0 18px}dd{padding:0 18px 4.5px}dd:last-of-type{border-bottom:1.08px solid #595959}dd+dt{border-top:1.08px solid #595959;padding-top:9px}blockquote{border-left:2.16px solid #595959;padding:4.5px 18px 4.5px 15.84px}blockquote footer{color:#595959;font-size:13.5px;margin:0}blockquote p{margin-bottom:0}img{height:auto;margin:0 auto}figure img{display:block}/*# sourceMappingURL=tacit-css-1.3.2.min.css.map */
      input{-webkit-appearance: none;-moz-appearance: none;appearance: none;}
      #carbonads{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",Helvetica,Arial,sans-serif}#carbonads{display:inline;max-width:330px;background-color:#f9f9f9;box-shadow:0 1px 4px 1px hsla(0,0%,0%,.1)}#carbonads a{color:inherit;text-decoration:none}#carbonads a:hover{color:inherit}#carbonads span{position:relative;display:block;overflow:hidden}#carbonads .carbon-wrap{display:flex}.carbon-img{display:block;margin:0;line-height:1}.carbon-img img{display:block}.carbon-text{font-size:13px;padding:10px;line-height:1.5;text-align:left}.carbon-poweredby{display:block;padding:8px 10px;background:repeating-linear-gradient(-45deg,transparent,transparent 5px,hsla(0,0%,0%,.025) 5px,hsla(0,0%,0%,.025) 10px) hsla(203,11%,95%,.4);text-align:center;text-transform:uppercase;letter-spacing:.5px;font-weight:600;font-size:9px;line-height:1}
        .menu-header{text-align:left;width: 100%;margin:20px auto;border-bottom:1px solid #d9d9d9;}.menu-header a {white-space:pre;color: black;font-size: 12pt;font-weight: bold;padding-right: 5px;}header{padding:0 10px;width:780px;margin:auto;}
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css" rel="stylesheet" />
  </head>
  <body>
    <header>
      <nav class="menu-header">
        <small>
            <a href="/">Jobs</a>&bull;
            <a href="/Golang-Developer-Salary-Remote">Salaries</a>&bull;
            <a href="/Companies-Using-Golang">Companies</a>&bull;
            <a href="/Golang-Developers">Developers</a>
          <br>
        </small>
      </nav>
    </header>
    <section style="margin:30px auto;">
      <article>
	    <h1 class="code-line" data-line-start=0 data-line-end=1 ><a id="Golang_Unzip_File_Example_0"></a>Golang Unzip File Example</h1>
<p class="has-line-data" data-line-start="2" data-line-end="3">In <a href="https://golang.cafe/blog/golang-zip-file-example.html">another article, we have covered how you can zip files with Go (Golang)</a>. In this article, we are going to look instead, at how you can decompress a zip archive by using Go (Golang) and just tools from the Go standard library.</p>
<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3J&placement=golangcafe" id="_carbonads_js"></script><br />
<p class="has-line-data" data-line-start="4" data-line-end="5">When working with zip archives, there is a package from the Go (Golang) standard library called <a href="https://golang.org/pkg/archive/zip">“archive/zip”</a>. The same package can be used both for archiving and un-archiving (decompressing) zip archives. It’s very minimal and easy to use. Let’s have a look at how we can unzip files in Go (Golang)</p>
<h3 class="code-line" data-line-start=6 data-line-end=7 ><a id="Open_the_zip_archive_using_zipOpenReader_6"></a>Open the zip archive using zip.OpenReader</h3>
<p class="has-line-data" data-line-start="8" data-line-end="9">The first thing we might need to do is to open the archive we want to decompress. In order to do that, you can use the method provided in the <em>archive/zip</em> standard library package, which allows you to open up an archive and returns a <a href="https://golang.org/pkg/io/#ReadCloser">io.ReadCloser</a> which is an instance of <a href="https://golang.org/pkg/os/#File">zip.Reader</a>. The method we are going to use is called <a href="">zip.OpenReader</a></p>
<pre><code class="language-go" data-line-start="11" data-line-end="13">func OpenReader(name string) (*ReadCloser, error)
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="14" data-line-end="15">OpenReader will open the Zip file specified by name and return a ReadCloser.</p>
</blockquote>
<h3 class="code-line" data-line-start=16 data-line-end=17 ><a id="Loop_through_zipReaders_files_16"></a>Loop through zip.Reader’s files</h3>
<p class="has-line-data" data-line-start="18" data-line-end="19">Once <em>zip.OpenReader</em> is called, a <em>io.ReadCloser</em> is returned. This is an instance of <a href="https://golang.org/pkg/archive/zip/#Reader">zip.Reader</a> which as you can see below, it has a slice of <a href="https://golang.org/pkg/archive/zip/#File">zip.File</a></p>
<pre><code class="language-go" data-line-start="21" data-line-end="27">type Reader struct {
    File    []*File
    Comment string
    // contains filtered or unexported fields
}
</code></pre>
<p class="has-line-data" data-line-start="28" data-line-end="29">The slice of <a href="https://golang.org/pkg/archive/zip/#File">zip.File</a> can be used to navigate through the archive contents.</p>
<h3 class="code-line" data-line-start=30 data-line-end=31 ><a id="Read_zip_archive_file_contents_by_using_zipFileOpen_30"></a>Read zip archive file contents by using zip.File.Open</h3>
<p class="has-line-data" data-line-start="32" data-line-end="33">Once your zip archive is opened, and you have a list of files to go through, you can use <a href="https://golang.org/pkg/archive/zip/#File.Open">zip.File.Open</a> to read file’s content and write it somewhere else (your decompressed output files)</p>
<pre><code class="language-go" data-line-start="35" data-line-end="37">func (f *File) Open() (io.ReadCloser, error)
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="38" data-line-end="39">Open returns a ReadCloser that provides access to the File’s contents. Multiple files may be read concurrently.</p>
</blockquote>
<h3 class="code-line" data-line-start=40 data-line-end=41 ><a id="Save_decompressed_files_contents_using_ioCopy_or_ioWriterWrite_40"></a>Save decompressed files’ contents using io.Copy or io.Writer.Write</h3>
<p class="has-line-data" data-line-start="42" data-line-end="43">The <em>zip.File.Open</em> returns an <a href="https://golang.org/pkg/io/#ReadCloser">io.ReadCloser</a> which can be used to read data from into a new output file, either by using <a href="https://golang.org/pkg/io/#Copy">io.Copy</a> or by just calling the Read function from the io.ReadCloser.</p>
<pre><code class="language-go" data-line-start="45" data-line-end="47">func Copy(dst Writer, src Reader) (written int64, err error)
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="48" data-line-end="49">Copy copies from src to dst until either EOF is reached on src or an error occurs. It returns the number of bytes copied and the first error encountered while copying, if any.</p>
</blockquote>
<h3 class="code-line" data-line-start=50 data-line-end=51 ><a id="Close_zip_files_using_zipReaderClose_50"></a>Close zip files using zip.Reader.Close</h3>
<p class="has-line-data" data-line-start="52" data-line-end="53">Every time you read a file’s content from the zip archive and copy it into your output, decompressed direcotry, you should close the file handler, by using the Close function from the <a href="https://golang.org/pkg/io/#ReadCloser">io.ReadCloser</a>.</p>
<pre><code class="language-go" data-line-start="55" data-line-end="68">type ReadCloser interface {
    Reader
    Closer
}

// Closer is the interface that wraps the basic Close method.
// The behavior of Close after the first call is undefined. 
// Specific implementations may document their own behavior.

type Closer interface {
    Close() error
}
</code></pre>
<h3 class="code-line" data-line-start=70 data-line-end=71 ><a id="Golang_Unzip_File_Code_Example_70"></a>Golang Unzip File Code Example</h3>
<p class="has-line-data" data-line-start="72" data-line-end="73">In this code example we try to decompress a zip archive that contains 2 files. There is 1 txt file and one csv file, which are going to be decompressed into a chosen <code>output</code> directory</p>
<pre><code class="language-go" data-line-start="75" data-line-end="131">package main

import (
    "archive/zip"
    "fmt"
    "io"
    "os"
    "path/filepath"
    "strings"
)

func main() {
    dst := "output"
    archive, err := zip.OpenReader("archive.zip")
    if err != nil {
        panic(err)
    }
    defer archive.Close()

    for _, f := range archive.File {
        filePath := filepath.Join(dst, f.Name)
        fmt.Println("unzipping file ", filePath)

        if !strings.HasPrefix(filePath, filepath.Clean(dst)+string(os.PathSeparator)) {
            fmt.Println("invalid file path")
            return
        }
        if f.FileInfo().IsDir() {
            fmt.Println("creating directory...")
            os.MkdirAll(filePath, os.ModePerm)
            continue
        }

        if err := os.MkdirAll(filepath.Dir(filePath), os.ModePerm); err != nil {
            panic(err)
        }

        dstFile, err := os.OpenFile(filePath, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, f.Mode())
        if err != nil {
            panic(err)
        }

        fileInArchive, err := f.Open()
        if err != nil {
            panic(err)
        }

        if _, err := io.Copy(dstFile, fileInArchive); err != nil {
            panic(err)
        }

        dstFile.Close()
        fileInArchive.Close()
    }
}
</code></pre>
<p class="has-line-data" data-line-start="132" data-line-end="133">This will output the following</p>
<pre><code class="language-go" data-line-start="135" data-line-end="138">unzipping file  output/csv/test.csv
unzipping file  output/txt/test.txt
</code></pre>
<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3J&placement=golangcafe" id="_carbonads_js"></script><br />
	
      </article>
          <article class="line-item" style="margin-top:20px;">
		  <div style="width: 50%;font-size:15pt;text-align:center;font-weight:bold;display:table;margin:20px auto;" id="email-subscribe-item-text">Join the Golang Developers Community on Golang Cafe</div>
                <input type="submit" onclick="window.location.href='/Submit-Developer-Profile'" id="email-subscribe-item-btn" value="Join the Community" style="width:50%;display:table;margin:5px auto;"/>
            </article>
  </section>
  <footer>
    <nav>
      <small>    
        <a href="/">Golang Jobs</a> &bull;
        <a href="/about">About Golang Cafe</a>
        <br>
      </small>
    </nav>
  </footer>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-go.min.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.js"></script>

  
</body>
</html>
