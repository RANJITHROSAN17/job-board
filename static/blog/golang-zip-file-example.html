<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Golang Zip File Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta name="title" content="Golang Zip File Example" />
    <meta name="keywords" content="golang, golang tutorial, golang zip, golang zip file, golang zip directory, golang zip file example, golang zip files, golang zip directories, golang zip multiple files, golang zip multiple files example" />
    <meta name="description" content="In this article we are going to see how to use Go zip package effectively to zip and unzip a file" />
    <meta itemprop="name" content="Golang Zip File Example">
    <meta itemprop="description" content="In this article we are going to see how to use Go zip package effectively to zip and unzip a file">
    <meta itemprop="image" content="https://golang.cafe/s/img/banner.jpg">
    <meta property="og:url" content="https://golang.cafe">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Golang Zip File Example">
    <meta property="og:description" content="In this article we are going to see how to use Go zip package effectively to zip and unzip a file">
    <meta property="og:image" content="https://golang.cafe/s/img/banner.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Golang Zip File Example">
    <meta name="twitter:description" content="In this article we are going to see how to use Go zip package effectively to zip and unzip a file">
    <meta name="twitter:image" content="https://golang.cafe/s/img/banner.jpg">
    <meta name="twitter:site" content="@golangcafe"/>
    <style type="text/css">
body{background:#ffffff;}
      input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}th{font-weight:600}td,th{border-bottom:1.08px solid #595959;overflow:auto;padding:14.85px 18px;text-align:left;vertical-align:top}thead th{border-bottom-width:2.16px;padding-bottom:6.3px}table{display:table;overflow-x:auto}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}fieldset{display:flex;flex-direction:row;flex-wrap:wrap}fieldset legend{margin:18px 0}input,textarea,select,button{border-radius:3.6px;display:inline-block;padding:9.9px}input+label,input+input[type="checkbox"],input+input[type="radio"],textarea+label,textarea+input[type="checkbox"],textarea+input[type="radio"],select+label,select+input[type="checkbox"],select+input[type="radio"],button+label,button+input[type="checkbox"],button+input[type="radio"]{page-break-before:always}input,select,label{margin-right:3.6px}textarea{min-height:90px;min-width:360px}label{display:inline-block;margin-bottom:12.6px}label+*{page-break-before:always}label>input{margin-bottom:0}input[type="submit"],input[type="reset"],button{background:#f2f2f2;color:#191919;cursor:pointer;display:inline;margin-bottom:18px;margin-right:7.2px;padding:6.525px 23.4px;text-align:center}input[type="submit"]:hover,input[type="reset"]:hover,button:hover{background:#d9d9d9;color:#000}input[type="submit"][disabled],input[type="reset"][disabled],button[disabled]{background:#e6e5e5;color:#403f3f;cursor:not-allowed}input[type="submit"],button[type="submit"]{background:#000090;color:#fff}input[type="submit"]:hover,button[type="submit"]:hover{background:#0000c5;color:#ffffff}input,select,textarea{margin-bottom:18px}input[type="text"],input[type="password"],input[type="email"],input[type="url"],input[type="phone"],input[type="tel"],input[type="number"],input[type="datetime"],input[type="date"],input[type="month"],input[type="week"],input[type="color"],input[type="time"],input[type="search"],input[type="range"],input[type="file"],input[type="datetime-local"],select,textarea{border:1px solid #595959;padding:5.4px 6.3px}input[type="checkbox"],input[type="radio"]{flex-grow:0;height:29.7px;margin-left:0;margin-right:9px;vertical-align:middle}input[type="checkbox"]+label,input[type="radio"]+label{page-break-before:avoid}select[multiple]{min-width:270px}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}kbd,samp,var,output{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:14.4px}pre{border-left:1.8px solid #59c072;line-height:25.2px;overflow:auto;padding-left:18px}kbd{background:#daf1e0;border-radius:3.6px;color:#2a6f3b;display:inline-block;line-height:18px;padding:3.6px 6.3px 2.7px}kbd{background:#2a6f3b;color:#fff}mark{background:#ffc;padding:0 3.6px}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}h1,h2,h3,h4,h5,h6{color:#000;margin-bottom:18px}h1{font-size:36px;font-weight:500;line-height:41.4px;margin-top:72px}h2{font-size:25.2px;font-weight:400;line-height:30.6px;margin-top:54px}h3{font-size:21.6px;line-height:27px;margin-top:36px}h4{font-size:18px;line-height:23.4px;margin-top:18px}h5{font-size:14.4px;font-weight:bold;line-height:21.6px;text-transform:uppercase}h6{color:#595959;font-size:14.4px;font-weight:bold;line-height:18px;text-transform:uppercase}input,textarea,select,button,option,html,body{font-family:Helvetica;font-size:18px;font-stretch:normal;font-style:normal;font-weight:400;line-height:29.7px}a{color:#000090;text-decoration:none}a:hover{text-decoration:underline}hr{border-bottom:1px solid #595959}figcaption,small{font-size:15.3px}figcaption{color:#595959}var,em,i{font-style:italic}dt,strong,b{font-weight:600}del,s{text-decoration:line-through}ins,u{text-decoration:underline}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}*{border:0;border-collapse:separate;border-spacing:0;box-sizing:border-box;margin:0;max-width:100%;outline:0;padding:0;vertical-align:baseline}html,body{width:100%}html{height:100%}body{color:#1a1919;}p,ul,ol,dl,blockquote,hr,pre,table,form,fieldset,figure,address{margin-bottom:29.7px}section{margin-left:auto;margin-right:auto;width:780px}article,header,footer{padding:43.2px}article{word-wrap: break-word;background:#fff;border:1px solid #d9d9d9;border-radius:7.2px}nav{text-align:center}nav ul{list-style:none;margin-left:0;text-align:center}nav ul li{display:inline-block;margin-left:9px;margin-right:9px;vertical-align:middle}nav ul li:last-child{margin-right:0}ol,ul{margin-left:31.5px}li dl,li ol,li ul{margin-bottom:0}dl{display:inline-block}dt{padding:0 18px}dd{padding:0 18px 4.5px}dd:last-of-type{border-bottom:1.08px solid #595959}dd+dt{border-top:1.08px solid #595959;padding-top:9px}blockquote{border-left:2.16px solid #595959;padding:4.5px 18px 4.5px 15.84px}blockquote footer{color:#595959;font-size:13.5px;margin:0}blockquote p{margin-bottom:0}img{height:auto;margin:0 auto}figure img{display:block}/*# sourceMappingURL=tacit-css-1.3.2.min.css.map */
      input{-webkit-appearance: none;-moz-appearance: none;appearance: none;}
      #carbonads{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",Helvetica,Arial,sans-serif}#carbonads{display:inline;max-width:330px;background-color:#f9f9f9;box-shadow:0 1px 4px 1px hsla(0,0%,0%,.1)}#carbonads a{color:inherit;text-decoration:none}#carbonads a:hover{color:inherit}#carbonads span{position:relative;display:block;overflow:hidden}#carbonads .carbon-wrap{display:flex}.carbon-img{display:block;margin:0;line-height:1}.carbon-img img{display:block}.carbon-text{font-size:13px;padding:10px;line-height:1.5;text-align:left}.carbon-poweredby{display:block;padding:8px 10px;background:repeating-linear-gradient(-45deg,transparent,transparent 5px,hsla(0,0%,0%,.025) 5px,hsla(0,0%,0%,.025) 10px) hsla(203,11%,95%,.4);text-align:center;text-transform:uppercase;letter-spacing:.5px;font-weight:600;font-size:9px;line-height:1}
        .menu-header{text-align:left;width: 100%;margin:20px auto;border-bottom:1px solid #d9d9d9;}.menu-header a {white-space:pre;color: black;font-size: 12pt;font-weight: bold;padding-right: 5px;}header{padding:0 10px;width:780px;margin:auto;}
    </style>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css" rel="stylesheet" />
  </head>
  <body>
    <header>
      <nav class="menu-header">
        <small>
            <a href="/">Jobs</a>&bull;
            <a href="/Golang-Developer-Salary-Remote">Salaries</a>&bull;
            <a href="/Companies-Using-Golang">Companies</a>&bull;
            <a href="/Golang-Developers">Developers</a>
          <br>
        </small>
      </nav>
    </header>
    <section style="margin:30px auto;">
      <article>
<h1 class="code-line" data-line-start=0 data-line-end=1 ><a id="Golang_Zip_File_Example_0"></a>Golang Zip File Example</h1>
<p class="has-line-data" data-line-start="2" data-line-end="3">Go (Golang) as many other programming languages, supports zip compression out of the box, right from within the standard library. In this article we are going to look at how we can create a zip archive in Go (Golang), and how we can add one or more files into a zip archive. We will be also able to create folders within the same zip archive, which can be useful in certain situations.</p>
<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3J&placement=golangcafe" id="_carbonads_js"></script><br />
<p class="has-line-data" data-line-start="4" data-line-end="5">When working with zip archives, there is a package from the Go (Golang) standard library called <a href="https://golang.org/pkg/archive/zip">“archive/zip”</a>. The purpose of this package is to provide support for creating and reading zip file archives.</p>
<h3 class="code-line" data-line-start=6 data-line-end=7 ><a id="Create_your_zip_archive_underlying_file_6"></a>Create your zip archive underlying file</h3>
<p class="has-line-data" data-line-start="8" data-line-end="9">The first thing you might have to do is create the archive as a simple file, like you would do with any other file in Go (Golang). Using the Go <a href="https://golang.org/pkg/os">os package</a> and the <a href="https://golang.org/pkg/os/#Create">os.Create</a> function</p>
<pre><code class="language-go" data-line-start="11" data-line-end="13">func Create(name string) (*File, error)
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="14" data-line-end="15">Create creates or truncates the named file. If the file already exists, it is truncated. If the file does not exist, it is created with mode 0666 (before umask). If successful, methods on the returned File can be used for I/O; the associated file descriptor has mode O_RDWR. If there is an error, it will be of type *PathError.</p>
</blockquote>
<h3 class="code-line" data-line-start=16 data-line-end=17 ><a id="Initialise_zip_archive_zipWriter_16"></a>Initialise zip archive zip.Writer</h3>
<p class="has-line-data" data-line-start="18" data-line-end="19">From the <em>archive/zip</em> package you will need to use the <a href="https://golang.org/pkg/archive/zip/#NewWriter">zip.NewWriter</a> function which will be used to write data (files and directories) to the final zip archive.</p>
<pre><code class="language-go" data-line-start="21" data-line-end="23">func NewWriter(w io.Writer) *Writer
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="24" data-line-end="25">NewWriter returns a new Writer writing a zip file to w.</p>
</blockquote>
<h3 class="code-line" data-line-start=26 data-line-end=27 ><a id="Add_files_to_the_archive_using_zipWriterCreate_26"></a>Add files to the archive using zip.Writer.Create</h3>
<p class="has-line-data" data-line-start="28" data-line-end="29">Once your zip writer is created, you can add files or directories to the zip archive. By using the <a href="https://golang.org/pkg/archive/zip/#Writer.Create">zip.Writer.Create</a> function</p>
<pre><code class="language-go" data-line-start="31" data-line-end="33">func (w *Writer) Create(name string) (io.Writer, error)
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="34" data-line-end="35">Create adds a file to the zip file using the provided name. It returns a Writer to which the file contents should be written. The file contents will be compressed using the Deflate method. The name must be a relative path: it must not start with a drive letter (e.g. C:) or leading slash, and only forward slashes are allowed. To create a directory instead of a file, add a trailing slash to the name. The file’s contents must be written to the io.Writer before the next call to Create, CreateHeader, or Close.</p>
</blockquote>
<h3 class="code-line" data-line-start=36 data-line-end=37 ><a id="Write_files_contents_using_ioCopy_or_ioWriterWrite_36"></a>Write files’ contents using io.Copy or io.Writer.Write</h3>
<p class="has-line-data" data-line-start="38" data-line-end="39">The <em>zip.Writer.Create</em> returns an <a href="https://golang.cafe/blog/golang-writer-example.html">io.Writer</a> which can be used to write data to, so any file content can be streamed and written into that writer, either by using <a href="https://golang.org/pkg/io/#Copy">io.Copy</a> or by just calling the Write function from the io.Writer</p>
<pre><code class="language-go" data-line-start="41" data-line-end="43">func Copy(dst Writer, src Reader) (written int64, err error)
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="44" data-line-end="45">Copy copies from src to dst until either EOF is reached on src or an error occurs. It returns the number of bytes copied and the first error encountered while copying, if any.</p>
</blockquote>
<h3 class="code-line" data-line-start=46 data-line-end=47 ><a id="Close_zip_archive_using_zipWriterClose_46"></a>Close zip archive using zip.Writer.Close</h3>
<p class="has-line-data" data-line-start="48" data-line-end="49">Once all the files and directories have been written to the archive, you can close the zip writer and finalise your zip archive, by using the <a href="https://golang.org/pkg/archive/zip/#Writer.Close">zip.Writer.Close</a> method on your zip archive which will write all the data into the underlying data stream.</p>
<pre><code class="language-go" data-line-start="51" data-line-end="53">func (w *Writer) Close() error
</code></pre>
<blockquote>
<p class="has-line-data" data-line-start="54" data-line-end="55">Close finishes writing the zip file by writing the central directory. It does not close the underlying writer.</p>
</blockquote>
<h3 class="code-line" data-line-start=57 data-line-end=58 ><a id="Golang_Zip_Archive_Code_Example_57"></a>Golang Zip Archive Code Example</h3>
<p class="has-line-data" data-line-start="59" data-line-end="60">In this code example we try to archive 2 files, 1 txt file and one csv file, into a single zip archive. The files are being archived inside different sub-directories within the archive itself.</p>
<pre><code class="language-go" data-line-start="62" data-line-end="115">package main

import (
    "archive/zip"
    "fmt"
    "io"
    "os"
)

func main() {
    fmt.Println("creating zip archive...")
    archive, err := os.Create("archive.zip")
    if err != nil {
        panic(err)
    }
    defer archive.Close()
    zipWriter := zip.NewWriter(archive)

    fmt.Println("opening first file...")
    f1, err := os.Open("test.csv")
    if err != nil {
        panic(err)
    }
    defer f1.Close()

    fmt.Println("writing first file to archive...")
    w1, err := zipWriter.Create("csv/test.csv")
    if err != nil {
        panic(err)
    }
    if _, err := io.Copy(w1, f1); err != nil {
        panic(err)
    }

    fmt.Println("opening second file")
    f2, err := os.Open("test.txt")
    if err != nil {
        panic(err)
    }
    defer f2.Close()

    fmt.Println("writing second file to archive...")
    w2, err := zipWriter.Create("txt/test.txt")
    if err != nil {
        panic(err)
    }
    if _, err := io.Copy(w2, f2); err != nil {
        panic(err)
    }
    fmt.Println("closing zip archive...")
    zipWriter.Close()
}
</code></pre>
<p class="has-line-data" data-line-start="116" data-line-end="117">This will output the following</p>
<pre><code class="language-go" data-line-start="119" data-line-end="126">creating zip archive...
opening first file...
writing first file to archive...
opening second file
writing second file to archive...
closing zip archive...
</code></pre>
<p class="has-line-data" data-line-start="127" data-line-end="128">The final zip archive contains the files as expected</p>
<pre><code class="language-go" data-line-start="130" data-line-end="139">$ unzip -l archive.zip
Archive:  archive.zip
Length  Date  Time  Name
---------  ---------- ----- ----
57  00-00-1980 00:00 csv/test.csv
12  00-00-1980 00:00 txt/test.txt
--------- -------
69 2 files
</code></pre>
<script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3J&placement=golangcafe" id="_carbonads_js"></script><br />
      </article>
          <article class="line-item" style="margin-top:20px;">
		  <div style="width: 50%;font-size:15pt;text-align:center;font-weight:bold;display:table;margin:20px auto;" id="email-subscribe-item-text">Join the Golang Developers Community on Golang Cafe</div>
                <input type="submit" onclick="window.location.href='/Submit-Developer-Profile'" id="email-subscribe-item-btn" value="Join the Community" style="width:50%;display:table;margin:5px auto;"/>
            </article>
  </section>
  <footer>
    <nav>
      <small>    
        <a href="/">Golang Jobs</a> &bull;
        <a href="/about">About Golang Cafe</a>
        <br>
      </small>
    </nav>
  </footer>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/prism.min.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-go.min.js"></script>
  <script async src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-javascript.js"></script>

  
</body>
</html>
